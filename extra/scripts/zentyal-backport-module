#!/bin/bash

if [ -z "$1" ]
then
    echo "Usage: $0 <rev>"
    echo
    echo "Example:"
    echo "~/branches/2.0/client/network\$ zentyal-backport-module 20123"
    echo
    exit 1
fi

rev=$1
arg="-c $rev"

module=$(basename `pwd`)

if [ "$module" = "ebox" ]
then
    module=core
elif [ "$module" = "libebox" ]
then
    module=common
elif [ "$module" = "usersandgroups" ]
then
    module=users
fi

if ! svn merge $arg https://svn.zentyal.org/zentyal/trunk/main/$module
then
    echo "merge failed"
    exit 1
fi

echo -e "\nPress return to see the diff..."
read
svn diff | less

echo -e "\nCopy and paste:\n"
echo svn ci -m "'NN: backport r$rev from trunk'"
echo
